remstart
/////////////////////////////////////////////////////
//
//   OpenFPS
//   MAIN SOURCE
//
//
/////////////////////////////////////////////////////

----- Changelog (main source file only):
(11/19/09) - BMacZero - Created
(11/23/09) - BMacZero - Added menu
(11/24/09) - BMacZero - [Removed BlitzTerrain temporarily]
(2/7/10)   - thenerd - Changed screen res to 1024x768x32 fullscreen, worked on menu functions
(2/15/10)  - BMacZero - Updated BlitzTerrain code for BT 2.0
(2/25/10)  - BMacZero - Globalized timerbased system, added shooting
(2/28/10)  - BMacZero - Removed BT temporary code

----- To-Do
Modules should be init between initMenu() and runMenu().

remend

/////////////////////////////////////////////////////////
// INIT                                                //
/////////////////////////////////////////////////////////

sync on : sync rate 60
set display mode 1024,768,screen depth(),1
autocam off
randomize timer()


`/ INITIATE CORE MODULES
initResource()


`/ START LOADING
initMenu()


`/ RUN MENU
runMenu()


`Init other modules here
initTerrain()
`Temporary
LoadTerrainFromFile("media/BlitzTerrain/Terrain.blitz","media/BlitzTerrain/texture.jpg","media/BlitzTerrain/detail.tga")

initMovement()
initShooting()
initAI()

//Setup camera
set camera range 10,10000
hide mouse

/////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////
// MAIN LOOP                                           //
/////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////

`Timerbased
global elapsedtime as float
global timer_starttime as dword
timer_starttime = timer()

do

`Timerbased
elapsedtime=(timer()-timer_starttime)/1000.0
timer_starttime = timer()

updateMovement()
updateShooting()
updateTerrain()
updateAI()

text 10,10,str$(screen fps())
text 10,20,"Stamina: "+str$(PLR_curstam)

sync
loop

terminateMovement()
terminateShooting()
terminateAI()
terminateResource()
terminateTerrain()
end
