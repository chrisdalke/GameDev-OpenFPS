remstart
/////////////////////////////////////////////////////
//
//   OpenFPS
//   MAIN SOURCE
//
//
/////////////////////////////////////////////////////

----- Changelog (main source file only):
(11/19/09) - BMacZero - Created
(11/23/09) - BMacZero - Added menu
(11/24/09) - BMacZero - [Removed BlitzTerrain temporarily]
(2/7/10)   - thenerd  - Changed screen res to 1024x768x32 fullscreen, worked on menu functions
(2/15/10)  - BMacZero - Updated BlitzTerrain code for BT 2.0
(2/25/10)  - BMacZero - Globalized timerbased system, added shooting
(2/28/10)  - BMacZero - Removed BT temporary code
(2/28/10)  - Kaedroho - Position mouse to centre of the screen added. This stops the program from exiting when using multiple monitors.
(6/23/10)  - miso     - Replaced 2 standard text command to the new UI_Text command, yet using placeholder fonts
(6/23/10)  - miso     - Added an UI_CenterText command, just to show how it works, can be deleted
(6/26/10)  - miso     - Wrote a To-Do note.
(6/27/10)  - thenerd  - Added some effects to the menu background.
(6/27/10)  - thenerd  - Added some effects to the menu background.
(6/27/10)  - miso     - Repositioned the texts to give space for the appearing console


----- To-Do
Modules should be init between initMenu() and runMenu().

Important note for all modules: don't use mousemovex() and mousemovey() commands, it clears the mouse movement buffer.
                                Instead, use SyS_MouseMoveX and SyS_MouseMoveY integer variables if needed,
                                they get their value every loop. (miso.)

remend

/////////////////////////////////////////////////////////
// INIT                                                //
/////////////////////////////////////////////////////////

sync on : sync rate 60
`set display mode 1024,768,screen depth(),1
autocam off
randomize timer()
hide mouse

`/ INITIATE CORE MODULES
initResource()

`/ INITIATE USER INTERFACE MODULE
UI_init():`best to init before initMenu(), it may use UI commands later.

`/ START LOADING
initMenu()


`/ RUN MENU
runMenu()


`Init other modules here
initTerrain()
`Temporary
LoadTerrainFromFile("media/BlitzTerrain/Terrain.blitz","media/BlitzTerrain/texture.jpg","media/BlitzTerrain/detail.tga")

initMovement()
initShooting()
initAI()

//Setup camera
set camera range 10,10000
hide mouse

/////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////
// MAIN LOOP                                           //
/////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////

`Timerbased
global elapsedtime as float
global timer_starttime as dword
timer_starttime = timer()

do

`Timerbased
elapsedtime=(timer()-timer_starttime)/1000.0
timer_starttime = timer()

updateMovement()
updateShooting()
updateTerrain()
updateAI()


UI_Text(1,10,50,str$(screen fps()))
UI_Text(1,10,60,"Stamina: "+str$(PLR_curstam))
UI_Text(2,10,75,"Different font")
UI_Centertext(3,UI_display.middlewidth,UI_display.height-40,"<Center Text Showcase, delete this line>")

position mouse screen width()/2,screen height()/2

//test command for mouse fade, can be deleted.

//handle all Gui functions
if DebugScreenFPS=1 then UI_Text(2,screen width()-50,screen height()-40,str$(screen fps())) 
UI_Handle()

sync
loop

terminateMovement()
terminateShooting()
terminateAI()
terminateResource()
terminateTerrain()
terminateUI()
end
